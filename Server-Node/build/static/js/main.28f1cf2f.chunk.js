(this.webpackJsonpreactapp=this.webpackJsonpreactapp||[]).push([[2],{299:function(e,t,n){},375:function(e,t,n){},382:function(e,t,n){"use strict";n.r(t);var c=n(12),a=n.n(c),r=n(112),o=n.n(r),s=(n(299),n(40)),i=n(212),u=n(11),l=n.n(u),b=n(201),p=n(22),d=n(271),j=(n(370),n(240)),h=n(281),f=(n(374),n(422)),O=n(421),g=n(423),m={uri:["https://graph.microsoft.com"],versions:["stagingbeta","stagingv1.0","beta","v1.0"],endpoints:["me","groups"],appId:"8a792f49-ae0d-4b9b-92d2-614fcba43bea",redirectUri:"http://localhost:8080/",scopes:["user.read","mailboxsettings.read","calendars.readwrite"]};function v(e){var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(n)}n(375);var x=n(88),S={auth:{clientId:"8a792f49-ae0d-4b9b-92d2-614fcba43bea",authority:"https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47",redirectUri:"http://localhost:3000"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:function(e,t,n){if(!n)switch(e){case j.a.Error:return void console.error(t);case j.a.Info:return void console.info(t);case j.a.Verbose:return void console.debug(t);case j.a.Warning:return void console.warn(t)}}}}};var k=function(){var e={scopes:["User.Read"]},t=Object(c.useState)(null),n=Object(p.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)({}),u=Object(p.a)(o,2),j=(u[0],u[1]),k=Object(c.useState)("Microsoft Graph"),y=Object(p.a)(k,2),I=y[0],w=y[1],N=Object(c.useState)("Sign In"),C=Object(p.a)(N,2),T=C[0],A=C[1],G=Object(c.useState)(null),L=Object(p.a)(G,2),P=L[0],J=L[1],R=Object(c.useState)(""),q=Object(p.a)(R,2),E=q[0],F=q[1],U=function(){var e=Object(b.a)(l.a.mark((function e(t){var n,c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),null===t){e.next=19;break}return F(t.account.homeAccountId),K(t.accessToken),e.next=6,v(t.accessToken);case 6:return n=e.sent,e.next=9,JSON.stringify(n);case 9:return c=e.sent,e.next=12,c.replaceAll(",",",\n");case 12:c=e.sent,$(c),W(!0),J(t.account),j(t),e.next=22;break;case 19:r=a.getAllAccounts(),console.log(r),!r||r.length<1?(M("loginRedirect"),A("Sign Out")):r.length>1||1===r.length&&(F(r[0].homeAccountId),J(r[0]),A("Sign Out"));case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function M(e){return B.apply(this,arguments)}function B(){return(B=Object(b.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n,t.abrupt("return",a.loginPopup(e).then(U).catch((function(e){console.log(e)})));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var D=Object(c.useState)(!1),H=Object(p.a)(D,2),V=H[0],W=H[1],z=Object(c.useState)(""),Q=Object(p.a)(z,2),_=Q[0],K=Q[1],X=Object(c.useState)(""),Y=Object(p.a)(X,2),Z=Y[0],$=Y[1];function ee(){return(ee=Object(b.a)(l.a.mark((function e(t,n){var c,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P){e.next=3;break}return alert("Login First"),e.abrupt("return",null);case 3:return t.account=n,e.next=6,a.acquireTokenSilent(t).catch(function(){var e=Object(b.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("silent token acquisition fails."),!(n instanceof a.InteractionRequiredAuthError)){e.next=6;break}return console.log("acquiring token using popup"),e.abrupt("return",a.acquireTokenPopup(t).catch((function(e){console.error(e)})));case 6:console.error(n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:return c=e.sent,console.log("getTokenPopup :",c),e.next=10,v(c.accessToken);case 10:return r=e.sent,e.next=13,JSON.stringify(r);case 13:return o=e.sent,e.next=16,o.replaceAll(",",",\n");case 16:return o=e.sent,$(o),K(c.accessToken),j(c),e.abrupt("return");case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var te=Object(c.useState)(""),ne=Object(p.a)(te,2),ce=ne[0],ae=ne[1],re=Object(c.useState)(""),oe=Object(p.a)(re,2),se=oe[0],ie=oe[1],ue=Object(c.useState)(""),le=Object(p.a)(ue,2),be=le[0],pe=le[1],de=Object(c.useState)(""),je=Object(p.a)(de,2),he=je[0];return je[1],Object(c.useEffect)((function(){r(new h.a(S))}),[]),Object(x.jsxs)("div",{className:"",children:[Object(x.jsxs)("div",{className:"nav row",children:[Object(x.jsx)("div",{className:"col-8",children:" Graph Helper "}),Object(x.jsxs)("div",{className:"col-4 btn-group",role:"group","aria-label":"...",children:[Object(x.jsx)("button",{type:"button",className:"btn",onClick:function(){w("Microsoft Graph"===I?"AAD Graph":"Microsoft Graph")},children:I}),Object(x.jsx)("button",{type:"button",className:"btn",onClick:function(){"Sign In"===T?a.handleRedirectPromise().then(U).catch((function(e){console.log(e)})):function(){var e={account:a.getAccountByHomeId(E)};a.logoutRedirect(e),A("Sign In"),K("")}()},children:T}),Object(x.jsxs)("button",{type:"button",className:"btn",onClick:function(){return console.log(function(e,t){return ee.apply(this,arguments)}(e,P))},children:["Get ",V?"New":""," Token"]})]})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-8 row",style:{background:"#f4f4fa"},children:[Object(x.jsx)("div",{className:"col-4",children:Object(x.jsx)(g.a,{style:{width:"100%"},value:ce,onChange:function(e,t){ae(t)},onInputChange:function(e,t){ae(t)},options:m.uri.map((function(e){return e})),renderInput:function(e){return Object(x.jsx)(f.a,Object(i.a)(Object(i.a)({},e),{},{label:"Graph Uri"}))}})}),Object(x.jsx)("div",{className:"col-2",children:Object(x.jsx)(g.a,{style:{width:"100%"},value:se,onChange:function(e,t){ie(t)},onInputChange:function(e,t){ie(t)},options:m.versions.map((function(e){return e})),renderInput:function(e){return Object(x.jsx)(f.a,Object(i.a)(Object(i.a)({},e),{},{label:"Version"}))}})}),Object(x.jsx)("div",{className:"col-4",children:Object(x.jsx)(g.a,{style:{width:"100%"},value:be,onChange:function(e,t){pe(t)},onInputChange:function(e,t){pe(t)},options:m.endpoints.map((function(e){return e})),renderInput:function(e){return Object(x.jsx)(f.a,Object(i.a)(Object(i.a)({},e),{},{label:"Endpoints"}))}})}),Object(x.jsx)("div",{className:"col-2",children:Object(x.jsx)(O.a,{onClick:function(){var e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uri:"https://graph.microsoft.com/",version:"v1.0",endpoint:"me"})};fetch("http://localhost:3000/GraphCall",e).then((function(e){return console.log(e.json())}))},variant:"contained",style:{marginTop:10,width:"100%"},children:"Query"})}),Object(x.jsx)("div",{className:"col-12",children:Object(x.jsx)(d.a,{height:"325px",language:"json",value:he,options:{selectOnLineNumbers:!0,roundedSelection:!1,cursorStyle:"line",automaticLayout:!0,theme:"vs-dark"}})})]}),Object(x.jsx)("div",{className:"col-4",style:{background:"#eee"},children:Object(x.jsx)(d.a,{height:"400px",language:"json",formatOnPaste:"true",value:String(Z),options:Object(s.a)({selectOnLineNumbers:!0,roundedSelection:!1,wordWrap:"on",autoIndent:!0,cursorStyle:"line",readOnly:!0,automaticLayout:!0,theme:"vs-dark",tabSize:2},"autoIndent",!0)})})]}),Object(x.jsxs)("p",{children:["msalInstance : ",a?a.length:"0"]}),Object(x.jsxs)("p",{children:["accessToken : ",_]}),Object(x.jsxs)("p",{children:["accountId : ",E]})]})},y=function(e){e&&e instanceof Function&&n.e(80).then(n.bind(null,501)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),r(e),o(e)}))};n(381);o.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(k,{})}),document.getElementById("root")),y()}},[[382,3,4]]]);
//# sourceMappingURL=main.28f1cf2f.chunk.js.map